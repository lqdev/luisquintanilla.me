<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>Luis Quintanilla - nixos</title>
    <link>https://www.lqdev.me/tags/nixos</link>
    <description>All content tagged with 'nixos' by Luis Quintanilla</description>
    <lastBuildDate>2024-07-14 14:49 -05:00</lastBuildDate>
    <language>en</language>
    <item>
      <title>Upgrade NixOS versions</title>
      <description>&lt;![CDATA[&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;This guide provides general guidance on upgrading between NixOS versions&lt;/p&gt;
&lt;h2&gt;Check which version you're currently running&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;cat /etc/lsb_release
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Get list of channels&lt;/h2&gt;
&lt;p&gt;This provides the URL used to download packages for nixos release&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-channel --list | grep nixos
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Add / Replace Software Channel&lt;/h2&gt;
&lt;p&gt;To get on the latest version, you need to update the &lt;code&gt;nixos&lt;/code&gt; channel to the latest version.&lt;/p&gt;
&lt;p&gt;You can find a list of versions in this &lt;a href="https://channels.nixos.org/"&gt;repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For example, if you wanted to upgrade to the latest 24.05 version, you'd use the following command:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-channel --add https://channels.nixos.org/nixos-24.05 nixos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The general format is: &lt;code&gt;nix-channel --add &amp;lt;CHANNEL_URL&amp;gt; nixos&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;Rebuild your system&lt;/h2&gt;
&lt;p&gt;Once you've configured the channel for the latest version, switch to it just like you would when upgading sofware packages.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nixos-rebuild switch --upgrade
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After the operation completes, you'll want to check which version is running as mentioned in previous instructions.&lt;/p&gt;
&lt;h2&gt;Additional Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://nlewo.github.io/nixos-manual-sphinx/installation/upgrading.xml.html"&gt;Upgrading Nix OS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/resources/wiki/nix-upgrade-versions</link>
      <guid>https://www.lqdev.me/resources/wiki/nix-upgrade-versions</guid>
      <pubDate>2024-07-14 14:49 -05:00</pubDate>
      <category>linux</category>
      <category>sysadmin</category>
      <category>nixos</category>
      <category>nix</category>
      <category>os</category>
    </item>
    <item>
      <title>Garbage Collections NixOS</title>
      <description>&lt;![CDATA[&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;One of the nice things about NixOS is, whenever you update the system, old configurations remain in place. That way if something were to go wrong, you can always revert back. However, there are tradeoffs. Each old configuration takes up space on your hard drive. If you're updating your system every week or every few weeks, this adds up. The following is a general guide on how to clean these up.&lt;/p&gt;
&lt;h2&gt;Delete old generations&lt;/h2&gt;
&lt;p&gt;This command deletes every generation, except the most current one.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-env --delete-generations old
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you'd like to keep a few of the most recent ones. Say, from the last 14 days, you can pass an argument.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-env --delete-generations 14d
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Run the garbage collector&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-store --gc
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Use the nix-collect-garbage utility&lt;/h2&gt;
&lt;p&gt;The following utility will delete older generations across all profiles on your system.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;nix-collect-garbage -d
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Resources&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://nixos.org/manual/nix/stable/package-management/garbage-collection.html"&gt;NixOS Garbage Collection&lt;/a&gt;&lt;/p&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/resources/wiki/nixos-garbage-collection</link>
      <guid>https://www.lqdev.me/resources/wiki/nixos-garbage-collection</guid>
      <pubDate>03/10/2024 14:01 -05:00</pubDate>
      <category>nixos</category>
      <category>system</category>
      <category>os</category>
      <category>linux</category>
    </item>
    <item>
      <title>FOSDEM 2024 Schedule</title>
      <description>&lt;![CDATA[[reshare] &lt;p&gt;Lots of great sessions. I'm looking forward to the sessions on the following topics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Matrix&lt;/li&gt;
&lt;li&gt;AI&lt;/li&gt;
&lt;li&gt;Nix / NixOS&lt;/li&gt;
&lt;li&gt;Software Defined Radio (SDR) &amp;amp; Amateur Radio&lt;/li&gt;
&lt;li&gt;Modern Email&lt;/li&gt;
&lt;li&gt;Collaboration &amp;amp; Content Management&lt;/li&gt;
&lt;/ul&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/responses/fosdem-2024-schedule</link>
      <guid>https://www.lqdev.me/responses/fosdem-2024-schedule</guid>
      <pubDate>2024-01-23 22:19 -05:00</pubDate>
      <category>fosdem</category>
      <category>opensource</category>
      <category>foss</category>
      <category>floss</category>
      <category>ai</category>
      <category>matrix</category>
      <category>nixos</category>
    </item>
    <item>
      <title>Install .NET packages on NixOS from GitHub</title>
      <description>&lt;![CDATA[&lt;h2&gt;Overview&lt;/h2&gt;
&lt;p&gt;This guide shows how to build a .NET package from GitHub source. The project used to illustrate the process can be found on &lt;a href="https://github.com/lqdev/fitch"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Create derivation&lt;/h2&gt;
&lt;p&gt;The first thing you'll want to do is create a derivation for your package.&lt;/p&gt;
&lt;p&gt;Create a file for your package. In this case, I called mine &lt;em&gt;fitch.nix&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Since I'm building a .NET package from the GitHub source, I use &lt;code&gt;buildDotnetModule&lt;/code&gt;, &lt;code&gt;dotnetCorePackages&lt;/code&gt;, and &lt;code&gt;fetchFromGithub&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To get the rev, use the &lt;code&gt;git log&lt;/code&gt; command. It's the hash of the latest commit.&lt;/p&gt;
&lt;h2&gt;Fake SHA&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;{
  fetchFromGitHub,
  buildDotnetModule,
  dotnetCorePackages
}:

buildDotnetModule {
  name = &amp;quot;fitch&amp;quot;;

  src = fetchFromGitHub {
    owner = &amp;quot;lqdev&amp;quot;;
    repo = &amp;quot;fitch&amp;quot;;
    rev = &amp;quot;e5fb91ddf57eb5611e0e313af29126e590cd149f&amp;quot;;
    sha256 = &amp;quot;&amp;quot;;
  };

  projectFile = &amp;quot;src/fitch.fsproj&amp;quot;;
  executables = &amp;quot;fitch&amp;quot;;
  dotnet-sdk = dotnetCorePackages.sdk_8_0;
  dotnet-runtime = dotnetCorePackages.runtime_8_0;
  nugetDeps = ./deps.nix;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;At this point the sha256 will be empty because you'll get it later in the process.&lt;/p&gt;
&lt;h2&gt;Create default.nix&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;let
  pkgs = import &amp;lt;nixpkgs&amp;gt; { };
in
{
  fitch = pkgs.callPackage ./fitch.nix { };
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Fetch dependencies&lt;/h2&gt;
&lt;p&gt;Create a file called &lt;code&gt;deps.nix&lt;/code&gt;. This will contain the dependencies you need for your application.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;touch deps.nix
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, run &lt;code&gt;nix-build -A fitch.fetch-deps&lt;/code&gt;. This should fail because of the empty SHA.&lt;/p&gt;
&lt;h2&gt;Update SHA&lt;/h2&gt;
&lt;p&gt;The empty SHA will fail. However, the error message will contain the actual SHA value. Copy that and paste it into the sha256 property.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;{
  lib    
  fetchFromGitHub,
  buildDotnetModule,
  dotnetCorePackages
}:

buildDotnetModule {
  name = &amp;quot;fitch&amp;quot;;

  src = fetchFromGitHub {
    owner = &amp;quot;lqdev&amp;quot;;
    repo = &amp;quot;fitch&amp;quot;;
    rev = &amp;quot;e5fb91ddf57eb5611e0e313af29126e590cd149f&amp;quot;;
    sha256 = &amp;quot;74xddAUGQNVliVs5o3zQQEAUAoF9r8iBmiiBr4qrUgw=&amp;quot;;
  };

  projectFile = &amp;quot;src/fitch.fsproj&amp;quot;;
  executables = &amp;quot;fitch&amp;quot;;
  dotnet-sdk = dotnetCorePackages.sdk_7_0;
  dotnet-runtime = dotnetCorePackages.runtime_7_0;
  nugetDeps = ./deps.nix;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Get dependencies&lt;/h2&gt;
&lt;p&gt;Now that you have the correct SHA, try getting the dependencies again. These dependencies are created in a series of steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Run the following command &lt;code&gt;sudo nix-build -A fitch.fetch-deps&lt;/code&gt;. The result of this command is an executable script called &lt;em&gt;result&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Run the &lt;em&gt;result&lt;/em&gt; script. &lt;code&gt;sudo ./result deps.nix&lt;/code&gt;. This will generate the lockfile called &lt;em&gt;deps.nix&lt;/em&gt; and is referenced by the &lt;code&gt;nugetDeps&lt;/code&gt; property.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Build package&lt;/h2&gt;
&lt;p&gt;Once everything is set up, run &lt;code&gt;nix-build -A fitch&lt;/code&gt;. This will package and install the package onto your system.&lt;/p&gt;
&lt;h2&gt;Add to configuration&lt;/h2&gt;
&lt;p&gt;To add the newly built package to your &lt;em&gt;configuration.nix&lt;/em&gt;, add it to your packages:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;environment.systemPackages = with pkgs; [
    #...
    (callPackage ./fitch.nix {})
    #...
];
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, run &lt;code&gt;nixos-rebuild switch&lt;/code&gt;. This should now install the package onto your PC.&lt;/p&gt;
&lt;h2&gt;(Optional) Initialize when shell starts&lt;/h2&gt;
&lt;p&gt;In my case, since I want fitch to run when the terminal starts, I edit my bash configuration in the &lt;em&gt;configuration.nix&lt;/em&gt; file.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;programs.bash = {
    interactiveShellInit = &amp;quot;fitch&amp;quot;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Sources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://ryantm.github.io/nixpkgs/languages-frameworks/dotnet/"&gt;Dotnet Nixpkgs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wuffs.org/blog/joining-the-nixos-pyramid-scheme"&gt;Joining the NixOS Pyramid Scheme&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://nix.dev/tutorials/learning-journey/packaging-existing-software"&gt;Packaging existing software with Nix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/resources/wiki/nixos-dotnet-packages-source</link>
      <guid>https://www.lqdev.me/resources/wiki/nixos-dotnet-packages-source</guid>
      <pubDate>12/17/2023 17:56 -05:00</pubDate>
      <category>dotnet</category>
      <category>nixos</category>
      <category>linux</category>
      <category>sysadmin</category>
      <category></category>
    </item>
    <item>
      <title>Running Waydroid on NixOS using X11</title>
      <description>&lt;![CDATA[&lt;h2&gt;Overview&lt;/h2&gt;
&lt;h2&gt;Packages&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://search.nixos.org/packages?channel=23.05&amp;amp;show=weston&amp;amp;from=0&amp;amp;size=50&amp;amp;sort=relevance&amp;amp;type=packages&amp;amp;query=weston"&gt;weston&lt;/a&gt; - Wayland compositor&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;NixOS Configuration&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;virtualisation = {
    waydroid = {
        enable = true;
    };
};

environment.systemPackages = with pkgs; [weston];
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Initialize Waydroid&lt;/h3&gt;
&lt;p&gt;This downloads the LineageOS image and installs it&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;# Fetch WayDroid images.
# You can add the parameters &amp;quot;-s GAPPS -f&amp;quot; to have GApps support.
sudo waydroid init
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Start Waydroid&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Open the terminal and start the waydroid container&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;sudo systemctl start waydroid-container
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Check status of container&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;sudo journalctl -u waydroid-container
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Open terminal and start weston&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;weston
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In the weston window, open a terminal and start Waydroid sesson in the background&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;waydroid session start &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Start the UI&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;waydroid show-full-ui
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Stop Waydroid&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Close weston window&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Stop waydroid container&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;sudo systemctl stop waydroid-container
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Remove user data&lt;/h4&gt;
&lt;p&gt;Only do this if you don't want to persist anything from that container&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;# Removing images and user data
sudo rm -r /var/lib/waydroid/* ~/.local/share/waydroid
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Update Android&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;sudo waydroid upgrade
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;General Usage&lt;/h3&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;# Start Android UI
waydroid show-full-ui

# List Android apps
waydroid app list

# Start an Android app
waydroid app launch &amp;lt;application name&amp;gt;

# Install an Android app
waydroid app install &amp;lt;/path/to/app.apk&amp;gt;

# Enter the LXC shell
sudo waydroid shell

# Overrides the full-ui width
waydroid prop set persist.waydroid.width 608
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://nixos.wiki/wiki/WayDroid"&gt;NixOS Wiki - WayDroid&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://unix.stackexchange.com/questions/732485/script-to-start-android-lineageos-with-waydroid-in-an-x11-session"&gt;Script to start LineageOS on X11&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/waydroid/waydroid/issues/195#issuecomment-953926526"&gt;Any plan to support X11?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/resources/wiki/waydroid-nixos-x11</link>
      <guid>https://www.lqdev.me/resources/wiki/waydroid-nixos-x11</guid>
      <pubDate>10/05/2023 22:25 -05:00</pubDate>
      <category>android</category>
      <category>linux</category>
      <category>nixos</category>
      <category>x11</category>
      <category>waydroid</category>
    </item>
    <item>
      <title>NixOS Configuration</title>
      <description>&lt;![CDATA[&lt;h2&gt;Description&lt;/h2&gt;
&lt;p&gt;This is my NixOS Configuration file&lt;/p&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Update configuration file&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Run the following command to apply changes&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-bash"&gt;sudo nixos-rebuild switch
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Snippet&lt;/h2&gt;
&lt;pre&gt;&lt;code class="language-nix"&gt;# Edit this configuration file to define what should be installed on
# your system.  Help is available in the configuration.nix(5) man page
# and in the NixOS manual (accessible by running ‘nixos-help’).

{ config, pkgs, ... }:

{
  imports =
    [ # Include the results of the hardware scan.
      ./hardware-configuration.nix
    ];

  # Bootloader.
  boot.loader.systemd-boot.enable = true;
  boot.loader.efi.canTouchEfiVariables = true;

  networking.hostName = &amp;quot;nixos&amp;quot;; # Define your hostname.
  # networking.wireless.enable = true;  # Enables wireless support via wpa_supplicant.

  # Configure network proxy if necessary
  # networking.proxy.default = &amp;quot;http://user:password@proxy:port/&amp;quot;;
  # networking.proxy.noProxy = &amp;quot;127.0.0.1,localhost,internal.domain&amp;quot;;

  # Enable networking
  networking.networkmanager.enable = true;

  # Set your time zone.
  time.timeZone = &amp;quot;America/New_York&amp;quot;;

  # Select internationalisation properties.
  i18n.defaultLocale = &amp;quot;en_US.UTF-8&amp;quot;;

  i18n.extraLocaleSettings = {
    LC_ADDRESS = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_IDENTIFICATION = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_MEASUREMENT = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_MONETARY = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_NAME = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_NUMERIC = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_PAPER = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_TELEPHONE = &amp;quot;en_US.UTF-8&amp;quot;;
    LC_TIME = &amp;quot;en_US.UTF-8&amp;quot;;
  };

  # Enable the X11 windowing system.
  # services.xserver.enable = true;
  services.xserver = {
    enable = true;

    desktopManager = {
      xterm.enable = false;
    };

    displayManager = {
      defaultSession = &amp;quot;none+i3&amp;quot;;
    };

    windowManager.i3 = {
       enable = true;
       extraPackages = with pkgs; [
         dmenu
	 i3status
         j4-dmenu-desktop
	 i3lock	
       ];
    };
  };

  # Enable the XFCE Desktop Environment.
  # services.xserver.displayManager.lightdm.enable = true;
  # services.xserver.desktopManager.xfce.enable = true;

  # Configure keymap in X11
  services.xserver = {
    layout = &amp;quot;us&amp;quot;;
    xkbVariant = &amp;quot;&amp;quot;;
  };

  # Enable CUPS to print documents.
  services.printing.enable = true;

  # Enable sound with pipewire.
  sound.enable = true;
  hardware.pulseaudio.enable = false;
  security.rtkit.enable = true;
  services.pipewire = {
    enable = true;
    alsa.enable = true;
    alsa.support32Bit = true;
    pulse.enable = true;
    # If you want to use JACK applications, uncomment this
    #jack.enable = true;

    # use the example session manager (no others are packaged yet so this is enabled by default,
    # no need to redefine it in your config for now)
    #media-session.enable = true;
  };

  # Enable touchpad support (enabled default in most desktopManager).
  # services.xserver.libinput.enable = true;

  # Enable gvfs
  services.gvfs.enable = true;

  # Define a user account. Don't forget to set a password with ‘passwd’.
  users.users.lqdev = {
    isNormalUser = true;
    description = &amp;quot;lqdev&amp;quot;;
    extraGroups = [ &amp;quot;networkmanager&amp;quot; &amp;quot;wheel&amp;quot; &amp;quot;docker&amp;quot;];
    packages = with pkgs; [
      firefox
      thunderbird
      vscode
      element-desktop
    ];
  };

  #Enable docker
  virtualisation.docker.enable = true;

  # Allow unfree packages
  nixpkgs.config.allowUnfree = true;

  # List packages installed in system profile. To search, run:
  # $ nix search wget
  environment.systemPackages = with pkgs; [
  #  vim # Do not forget to add an editor to edit configuration.nix! The Nano editor is also installed by default.

  # Utilities
    wget
    emacs
    alacritty
    mc
    du-dust
    htop
    feh
    duf
    shutter
    gparted
    keepassxc
    bitwarden
    git
    yt-dlp
    streamlink
    ffmpeg
    gnome.seahorse
    xfce.thunar-volman
    xfce.xfconf

  # Media
  
    mpv
    vlc
    
  # Dotnet
    (with dotnetCorePackages; combinePackages [
      dotnet-sdk
      dotnet-sdk_7
    ])
  # Development
  
    docker
    cargo
    rustc

  # Office
  
    libreoffice
  ];

  # Some programs need SUID wrappers, can be configured further or are
  # started in user sessions.
  # programs.mtr.enable = true;
  # programs.gnupg.agent = {
  #   enable = true;
  #   enableSSHSupport = true;
  # };

  # Bash Configuration
  programs.bash = {
    shellAliases = {
      emacs=&amp;quot;emacs -nw&amp;quot;;
    };
  };

  # Thunar
  programs.thunar.enable = true;

  # List services that you want to enable:

  # Enable the OpenSSH daemon.
  # services.openssh.enable = true;

  # Open ports in the firewall.
  # networking.firewall.allowedTCPPorts = [ ... ];
  # networking.firewall.allowedUDPPorts = [ ... ];
  # Or disable the firewall altogether.
  # networking.firewall.enable = false;

  # This value determines the NixOS release from which the default
  # settings for stateful data, like file locations and database versions
  # on your system were taken. It‘s perfectly fine and recommended to leave
  # this value at the release version of the first install of this system.
  # Before changing this value read the documentation for this option
  # (e.g. man configuration.nix or on https://nixos.org/nixos/options.html).
  system.stateVersion = &amp;quot;23.05&amp;quot;; # Did you read the comment?

}
&lt;/code&gt;&lt;/pre&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/resources/snippets/nixos-configuration</link>
      <guid>https://www.lqdev.me/resources/snippets/nixos-configuration</guid>
      <pubDate>08/22/2023 18:45 -05:00</pubDate>
      <category>nix</category>
      <category>linux</category>
      <category>configuration</category>
      <category>nixos</category>
      <category>os</category>
    </item>
    <item>
      <title>First Steps with NixOS</title>
      <description>&lt;![CDATA[
## Introduction

For the longest time, when using Linux distributions, I chose those that were Debian-based. I still do for servers. However, on the dekstop I switched to [Manjaro](https://manjaro.org/), which is Arch-based, about two years ago. Two years is a long time without distro-hopping, so I was long overdue. I've been following the [NixOS](https://nixos.org/) project for some time but since I was happy with my setup, I didn't consider making the switch. However, a month ago, I decided to [dip my toes](/notes/maybe-switching-nixos). I installed NixOS on a flash drive and started tinkering with it. In this post, I'll provide some of my initial impressions and things I find appealing about the OS.

## Declarative configuration

One of the first things I did when I booted into my new NixOS installation was get familiar with the [configuration file](https://nixos.wiki/wiki/Overview_of_the_NixOS_Linux_distribution#Declarative_Configuration). The configuration file is authored using the [Nix programming language](https://nix.dev/tutorials/first-steps/nix-language) and it's the place where you configure your entire system, including services, packages, and desktop environments. The best way I can describe it is a Dockerfile for your desktop. If interested, you can find my [config file](/resources/snippets/nixos-configuration/) on the scripts section of this website. 


There's a few advantages to this approach:

1. **Configurations are stored in a single place** - The advantage to this is, I don't have to figure out where the configuration files for each of the components of my system are. I can manage everything in one place. A perfect example where the configuration file goes beyond what I expected was being able to include my bash configuration. Typically, I'd have that configuration in my `bashrc` file. With NixOS, I can just include that in the configuration file as follows:


    ```nix
    programs.bash = {
        shellAliases = {
            emacs="emacs -nw";
        };
    };
    ```

1. **Enables composition** - Because the configuration file is effectively a script, I can modularize the difference pieces. For example, if I wanted to split out my service and package configurations into separate files, I can do so and reference those individual files from my configuration file, separating concerns while still keeping my system configuration simple. 
1. **Version control** - Because the configuration file is just like any other plain text file, it means I can check it into the version control system or cloud service of my choice and manage it that way. In doing so, not only can I roll back using the built-in NixOS mechanisms, but I have another layer of security in case I need to recover that file. 

Now, because I can define everything about my system in the configuration file, this means I can seamlessly rebuild my entire system using this single file in a reproducible manner.

## Reproducible builds

I got to experience first-hand how the configuration file can simplify out-of-box-experiences and system configurations. Initially, I did not install NixOS on my main hard drive. All of my configuration and learning took place on a flash drive. Once I got my configuration to a place I was satisfied, it was time to take the plunge and reimage my PC. In the past, when I've done something similar, I've had to document everything I did when configuring my system. That's where posts like [Setting up a new Ubuntu PC](/posts/setting-up-new-ubuntu-pc/) come from. With NixOS, all I needed to do was replace my configuration file with the one I configured on the flash drive. Then, when I ran `nixos-rebuild switch`, my system was configured exactly like the one on the flash drive. 

## Risk-free software evaluations

This is something I haven't tried yet, but I could easily see it coming in handy. Sometimes I might need a piece of software to do one thing or maybe I want to see whether it'll solve a problem I'm facing. In order to try it out and use it, I need to install it globally. This can cause changes to my system permanently that I don't want. With NixOS, you can create [ad-hoc shell environments](https://nix.dev/tutorials/first-steps/ad-hoc-shell-environments#ad-hoc-shell-environments). These environments make temporary changes to your system, so you can evaluate a piece of software or use it that one time. Then, when you exit the environment, the software is no longer installed in your system.

## Large package selection

A [large package selection](https://search.nixos.org/packages) to choose from is something I got used to with Manjaro. Being an Arch-based distribution, I had access to the [Arch User Repository (AUR)](https://aur.archlinux.org/). Moving to NixOS, it's nice to know that in this area, NixOS offers great support. Additionally, NixOS has built-in support for [Flatpak](https://nixos.wiki/wiki/Flatpak)

## Still exploring

There's still a few things I don't really get. For example, when installing the .NET SDK, I wanted to have side-by-side installs of the latest STS (7.0) and LTS (6.0). However, including the package names in my configuration file didn't work as expected. Instead I had to use the following convention.

```nix
(with dotnetCorePackages; combinePackages [
    dotnet-sdk
    dotnet-sdk_7
])
```

As I learn more, this will probably make more sense but for now it's a mystery. 

## Conclusion

Overall, I'm happy with NixOS and I can see myself using it for the long-term. Hopefully longer than two years. I'm not a gamer so I can't say how well it does in that front. For web browsing and software development though, I really like what NixOS has to offer. If some of the things I mentioned above sound interesting, I'd encourage you to install it on a flash drive and start tinkering with it. ]]&gt;</description>
      <link>https://www.lqdev.me/posts/first-steps-nixos</link>
      <guid>https://www.lqdev.me/posts/first-steps-nixos</guid>
      <pubDate>2023-08-22 18:03 -05:00</pubDate>
      <category>nixos</category>
      <category>linux</category>
      <category>os</category>
      <category>nix</category>
      <category>sysadmin</category>
      <category>floss</category>
    </item>
    <item>
      <title>Thinking of switching to NixOS</title>
      <description>&lt;![CDATA[&lt;p&gt;Time to distro hop. Maybe. For the past two years I've been happily using Manjaro as my main distribution. During that time I've also kept an eye on the immutable distributions. One of the main ones I've been paying attention to is &lt;a href="https://nixos.org/"&gt;NixOS&lt;/a&gt;. Like Arch, it's taken me some time to wrap my head around it. Now that it's gotten easier to set up through a graphical installer, I'll start out with a live install to see how I like it.&lt;/p&gt;
]]&gt;</description>
      <link>https://www.lqdev.me/notes/maybe-switching-nixos</link>
      <guid>https://www.lqdev.me/notes/maybe-switching-nixos</guid>
      <pubDate>2023-07-21 17:15 -05:00</pubDate>
      <category>linux</category>
      <category>nixos</category>
    </item>
  </channel>
</rss>