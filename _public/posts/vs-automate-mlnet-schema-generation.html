<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/bootstrap-icons-1.5.0/bootstrap-icons.css"><link rel="stylesheet" href="/css/highlight-dark.min.css"><link rel="stylesheet" href="/css/main.css"><meta property="og:title" content="Automate ML.NET model schema generation from sample JSON data with Visual Studio - Luis Quintanilla"><meta property="og:type" content="website"><meta property="og:image" content="https://www.luisquintanilla.me/avatar.png"><meta property="og:image:secure_url" content="https://www.luisquintanilla.me/avatar.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="200"><meta property="og:image:height" content="200"><meta property="og:site_name" content="Luis Quintanilla Personal Website"><meta property="og:locale" content="en_US"><meta property="twitter:image" content="https://www.luisquintanilla.me/avatar.png"><meta name="robots" content="noindex,nofollow,nosnippet"><title>Automate ML.NET model schema generation from sample JSON data with Visual Studio - Luis Quintanilla</title></head><body><nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"><a class="navbar-brand" href="/"><img src="/avatar.png" height="32" width="32" class="d-inline-block align-top rounded-circle" style="margin-right:5px">Luis Quintanilla</a><button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/">Home</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="aboutDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About</a><div class="dropdown-menu" aria-labelledby="aboutDropdown"><a class="dropdown-item" href="/about.html">About Me</a><a class="dropdown-item" href="/irl-stack.html">IRL Stack</a><a class="dropdown-item" href="/colophon.html">Colophon</a></div></li><li class="nav-item"><a class="nav-link" href="/contact.html">Contact</a></li><li class="nav-item"><a class="nav-link" href="/posts/1">Blog</a></li><li class="nav-item"><a class="nav-link" href="/events.html">Events</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="feedDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Feeds</a><div class="dropdown-menu" aria-labelledby="feedDropdown"><a class="dropdown-item" href="/feed/index.html">Main</a><a class="dropdown-item" href="/feed/notes.html">Notes</a><a class="dropdown-item" href="/feed/videos.html">Videos</a><div class="dropdown-divider"></div><a class="dropdown-item" href="/feed/blogroll.html">Blogroll</a></div></li></ul><a href="/about.html#subscribe"><svg class="bi bi-rss text-secondary" fill="currentColor" viewBox="0 0 16 16" height="32" width="32"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"></path><path d="M5.5 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-3-8.5a1 1 0 0 1 1-1c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1-1-1zm0 4a1 1 0 0 1 1-1 6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1-1-1z"></path></svg></a></div></nav><main role="main" class="container"><div class="mr-auto"><h2>Introduction</h2>
<p>When using ML.NET models to make predictions, you often have to define classes for the model's input and output schema. In a previous post, I showed how you can <a href="/posts/inspect-mlnet-models-netron.html">use Netron to inspect ML.NET models</a> and manually define classes to represent the input and output schema for your model. That works for models that don't have a lot of features / columns. However, as the number of columns grows, it can become cumbersome to define these classes. Visual Studio has a feature that can help automate that process. Assuming you have a sample of your input and output data in JSON format, you can leverage a built-in feature &quot;Paste JSON As Classes&quot; to take the sample and convert it to a class. In this post, I'll show how to do that.</p>
<h2>Prerequisites</h2>
<ul>
<li>Visual Studio 2019. Though I haven't tested with VS2022, I assume &quot;Paste JSON As Classes&quot; is also available there.</li>
</ul>
<h2>Convert sample JSON data to C# classes</h2>
<p>In this post, I'll work with the <em>sentiment_model.zip</em> model to classify sentiment, which you can find in the <a href="https://github.com/dotnet/samples/blob/main/machine-learning/models/sentimentanalysis/sentiment_model.zip">dotnet/samples</a> repo.</p>
<p>The model input has 3 columns:</p>
<ul>
<li>SentimentText (string)</li>
<li>Label (boolean)</li>
<li>SamplingKeyColumn (float32)</li>
</ul>
<p>The model output has at least 2 columns since it uses a binary classification algorithm. For information on expected output columns based on the machine learning algorithm/task, see the <a href="https://docs.microsoft.com/dotnet/machine-learning/resources/tasks#binary-classification-inputs-and-outputs">ML.NET tasks article</a>.</p>
<ul>
<li>Score (Single). Single is a single-precision floating-point number.</li>
<li>PredictedLabel (boolean)</li>
</ul>
<p>With that in mind, let's then assume that we have sample input data in JSON format that looks as follows.</p>
<pre><code class="language-json">{
    &quot;SentimentText&quot;: &quot;This was a very bad steak&quot;,
    &quot;Label&quot;: false,
    &quot;SamplingKeyColumn&quot;: 1.0
}
</code></pre>
<p>Inside a C# project in Visual Studio:</p>
<ol>
<li><p>Create a C# class</p>
<ol>
<li>Right-click your project.</li>
<li>Select <strong>Add &gt; Class</strong>.</li>
<li>Provide a name for your class in the New Item dialog.</li>
</ol>
</li>
<li><p>Copy the input JSON data sample to your clipboard.</p>
</li>
<li><p>Place your cursor inside the namespace block of your newly created class.</p>
</li>
<li><p>In the Visual Studio toolbar, select <strong>Edit &gt; Paste Special &gt; Paste JSON as Classes</strong>.</p>
</li>
<li><p>The result should look similar to the following:</p>
<pre><code class="language-csharp">public class Rootobject
{
    public string SentimentText { get; set; }
    public bool Label { get; set; }
    public float SamplingKeyColumn { get; set; }
}
</code></pre>
</li>
<li><p>Rename the class to something more descriptive like <code>ModelInput</code>. The class should look similar to the following:</p>
<pre><code class="language-csharp">public class ModelInput
{
    public string SentimentText { get; set; }
    public bool Label { get; set; }
    public float SamplingKeyColumn { get; set; }
}
</code></pre>
</li>
<li><p>Create a JSON data sample for your output. In this case it'd look something like:</p>
<pre><code class="language-json">{
    &quot;Score&quot;: 1.0,
    &quot;PredictedLabel&quot;: false
}
</code></pre>
</li>
<li><p>Repeat steps 1-6 for your output JSON data sample. The resulting class should look similar to the following:</p>
<pre><code class="language-csharp">public class ModelOutput
{
    public float Score { get; set; }
    public bool PredictedLabel { get; set; }
}
</code></pre>
</li>
</ol>
<p>It's important to note that the name of the class does not matter as long as the column names and types are the same the ones the model expects.</p>
<p>At this point, you can go through the process of <a href="https://docs.microsoft.com/dotnet/machine-learning/how-to-guides/machine-learning-model-predictions-ml-net">using the model to make predictions on new data</a>.</p>
<h2>Conclusion</h2>
<p>Although the model used in this post does not have many columns, when you have many columns &quot;Paste JSON As Classes&quot; can significantly simplify the process of creating your input and output schema classes for ML.NET models. Happy coding!</p>
</div></main><script src="/lib/jquery/jquery.slim.min.js"></script><script src="/lib/boostrap/bootstrap.min.js"></script><script src="/lib/highlight/highlight.min.js"></script><script src="/lib/highlight/highlight.fsharp.min.js"></script><script type="application/javascript">hljs.initHighlightingOnLoad();</script></body><footer><a rel="me" href="https://toot.lqdev.tech/@lqdev"></a></footer></html>