<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/text/assets/text-only.css"><meta name="description" content="Text-only accessible version of Luis Quintanilla&#39;s website"><meta name="robots" content="noindex, nofollow"><title>Super simple captcha - Text-Only Site</title></head><body><a href="#main-content" class="skip-link">Skip to main content</a><header role="banner"><h1><a href="/text/">Luis Quintanilla</a></h1><p>Text-Only Accessible Website</p></header><nav role="navigation" aria-label="Main navigation"><ul><li><a href="/text/">Home</a></li><li><a href="/text/about/">About</a></li><li><a href="/text/contact/">Contact</a></li><li><a href="/text/content/">All Content</a></li><li><a href="/text/feeds/">RSS Feeds</a></li><li><a href="/text/help/">Help</a></li></ul></nav><main role="main" id="main-content"><div><h1>Super simple captcha</h1><div class="content-meta"><div class="content-type">posts</div><time datetime="2021-10-24">October 24, 2021</time><p>Tags: web development, html, javascript, webmentions</p></div><p><a href="/text/">← Home</a> | <a href="/text/content/posts/">← All posts</a> | <a href="https://www.lqdev.me/posts/super-simple-captcha">View Full Version</a></p><div class="content"><h2>Introduction</h2>
<p>I've been thinking about implementing webmentions on this site. According to the spec, &quot;Webmention is a simple way to notify any URL when you mention it on your site. From the receiver's perspective, it's a way to request notifications when other sites mention it&quot;. I won't get into the technical details of webmentions in this post, but the simplest way to implement webmentions is to have a text input box on your site for each of your articles, kind of like a comment box. When someone wants to mention your post on their site, they can use the text input box on your site to add the URL from their site where they mention your post. When the user submits the webmention, there's some endpoint that listens for webmention submissions and processes them accordingly. If you're interested in learning more about webmentions, you can check out the following resources:</p>
<ul>
<li><a href="https://www.w3.org/TR/webmention/">Webmentions spec</a></li>
<li><a href="https://webmention.rocks/">Webmention Rocks</a></li>
<li><a href="https://yewtu.be/watch?v=ZOlkS6xP2Zk">Sending Your First Webmention - IndieWebCamp Düsseldorf 2019</a></li>
</ul>
<p>While it's great that you can mention and comment on other people's content from your site, like comments, writing a script to submit spam is relatively simple. Therefore, I want to create some sort of <a href="https://en.wikipedia.org/wiki/CAPTCHA">CAPTCHA</a> challenge as an initial form of validation to prevent spam. At the same time, I don't want to have any external dependencies. In this post, I'll show how I went about implementing a captcha-like solution with zero dependencies to prevent spam submissions.</p>
<h2>Simple captcha</h2>
<p>The solution I came up with asks the users to add the day of the month (1-31) to a random number between 1-100. While not entirely foolproof, it's &quot;complex&quot; enough that it's not the same thing every time.</p>
<p>Below is what the implementation looks like.</p>
<p><a href="https://user-images.githubusercontent.com/11130940/138604591-dfe4c301-78fe-4338-a751-799b420a1791.png" target="_blank">[Image: Captcha implementation asking for date]</a></p>
<p>The HTML markup for the webpage looks like the following:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Super Simple Captcha&lt;/title&gt;
    &lt;script src=&quot;main.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;setQuery()&quot;&gt;
    &lt;div&gt;
        &lt;span id=&quot;query&quot;&gt;&lt;/span&gt;
        &lt;input type=&quot;text&quot; id=&quot;answerInput&quot;&gt;
        &lt;button onclick=&quot;displayResult()&quot;&gt;Submit&lt;/button&gt;
    &lt;/div&gt;
    &lt;h3 id=&quot;result&quot;&gt;&lt;/h3&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>When the <code>body</code> element of the page loads, it invokes the <code>setQuery</code> function, which displays the challenge the user is supposed to solve in the <code>query</code> span element.</p>
<p>The user then submits their answer via the <code>answerInput</code> text input box.</p>
<p>The answer is then checked by invoking the <code>displayResult</code> function. The <code>displayResult</code> function checks the user's answer against the expected answer. If the answer is correct, the text &quot;OK&quot; is displayed on the page's <code>result</code> H3 element. Otherwise, the text &quot;Try again&quot; displays on the webpage.</p>
<p>All of the code that handles this logic is in the <code>main.js</code> file.</p>
<pre><code class="language-javascript">let date = new Date()
let day = date.getDate() // Day of the month
let randomNumber = Math.floor(Math.random() * 100) + 1
let answer = day + randomNumber // Expected answer

let setQuery = () =&gt; {
    let element = document.getElementById('query');
    element.innerText = `Enter the sum of ${day} + ${randomNumber}`;    
}

let checkAnswer = () =&gt; {
    let userAnswer = parseInt(document.getElementById(&quot;answerInput&quot;).value);
    return answer === userAnswer
}

let displayResult = () =&gt; {
    let result = checkAnswer() ? &quot;OK&quot; : &quot;Try again&quot; // Ternary function to check if answer is correct
    document.getElementById(&quot;result&quot;).innerText = result;
}
</code></pre>
<p>That's all there is to it!</p>
<h2>Conclusion</h2>
<p>In this post, I showed how to implement a dependency-free solution to present a challenge to users submitting comments / webmentions to your site. Although the solution isn't foolproof, it's just complex enough any spammers would have to work a little harder. Happy coding!</p>
</div></div></main><footer role="contentinfo"><hr><p><a href="/">Full Site</a> | <a href="/text/accessibility/">Accessibility</a></p></footer></body></html>